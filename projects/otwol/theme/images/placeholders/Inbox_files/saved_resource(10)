/* (c) Copyright 1985-2011 IBM Corporation. All rights reserved. */
/* $HaikuForm - 481.21 */
                                              
         function EPw(oNote, oBody){var EbX={jpg: void 0, jpeg: void 0, jpe: void 0, jfif: void 0, gif: void 0};var ELN={art: void 0, bmp: void 0, dib: void 0, png: void 0, wmf: void 0, xbm: void 0};var EGu={};var EWQ={};var Gdz=[oBody];for (var EnM=oBody.getElementsByTagName('iframe'), i=0;i<EnM.length;i++){try{if (EnM[i].id.indexOf('-bodyiframe') > 0 && EnM[i].contentWindow.document.body) Gdz.push(EnM[i].contentWindow.document.body);} catch (e){}} var HMb=[];for (var k=0;k < Gdz.length;k++){for (var EQx=Gdz[k].getElementsByTagName('div'), i=0;i < EQx.length;i++){if (EQx[i].getAttribute('id') == 'MIMEAttachInfoDiv' && EQx[i].title){var ECl=EQx[i].title.split('|');if (ECl[0] == 'applefile'){var HJd={sName: ECl[2] ? ECl[2] : ECl[1], Bem: ECl[1]};EGu[HJd.sName]=HJd;} if (ECl[2] && ECl[1] != ECl[2]) EWQ[ECl[2]]=ECl[1];HMb.push(ECl[2] ? ECl[2] : ECl[1]);}} for (var aoImg=Gdz[k].getElementsByTagName('img'), i=0;i < aoImg.length;i++){try{if (aoImg[i].src == 'medoc.gif' && aoImg[i].nextSibling) HMb.push(aoImg[i].nextSibling.nodeValue);} catch (e){}}} if (oNote.EHA('h_AttachmentNamesAlt') && oNote.EHA('h_AttachmentNamesAlt') != "QPNULL"){var Ehm=oNote.EHA('h_AttachmentNamesAlt').replace(/\",\"/g, '\"__DELIM__\"').split('__DELIM__');var EKT=oNote.EHA('s_AttachmentTimesAlt').split(',');var EnZ=Ehm;var EkR=oNote.EHA('h_AttachmentLengthsAlt').split(',');} else{var Ehm=oNote.EHA('h_AttachmentNames');var EKT=oNote.EHA('s_AttachmentTimes');var EnZ=oNote.EHA('s_AllAttachmentNames');var EkR=oNote.EHA('s_AllAttachmentLengths');} var ELV=(Ehm instanceof Array ? Ehm : Ehm ? [Ehm] : []);var EKs=(EKT instanceof Array ? EKT[0].split(';') : EKT ? EKT.split(';') : []);var EZL=(EnZ instanceof Array ? EnZ : EnZ ? [EnZ] : []);var Eat=(EkR instanceof Array ? EkR : EkR ? [EkR] : []);var EVt=[];for (var i=0;i < EZL.length;i++){if (!EZL[i]) continue;var BiL=EZL[i].split('.');var sCid=BiL.slice(1, BiL.length - 1).join('.');var sExt=(BiL[BiL.length - 1] ? BiL[BiL.length - 1] : '').toLowerCase();var Gjn=sExt in EbX;var GtC=sExt in ELN;var ERc=((BiL[0] ? BiL[0] : '').toLowerCase() == 'image' && (!!sCid && ((!(/[^0-9]/.test(sCid)) && Gjn) || (sCid.indexOf('@') >= 0 && (Gjn || GtC)))));var GwK=BiL.length > 1 && sExt.length >= 3 && !(/[^0-9]/.test(sExt));var GxL='';if (GwK) GxL=BiL.slice(0, BiL.length - 1).join('.');var Qo=ESp(ELV, EZL[i]);if (EZL[i] in EGu){EGu[EZL[i]].gM=Eat[i];if (Qo >= 0 && EKs.length > Qo) EGu[EZL[i]].sTime=EKs[Qo];continue;} if ((ERc && ESp(ELV, EZL[i]) < 0) || /^\$MIME_PART_/.test(EZL[i]) || /^smime\.p7/.test(EZL[i]) || (ESp(ELV, EZL[i]) < 0 && ((!GwK && ESp(HMb, EZL[i]) < 0) || (GwK && (ESp(HMb, EZL[i]) < 0 || ESp(HMb, GxL) < 0))))) continue;var ELb={sName: EZL[i], Bem: EWQ[EZL[i]] ? EWQ[EZL[i]] : EZL[i], gM: Eat[i]};if (Qo >= 0 && EKs.length > Qo) ELb.sTime=EKs[Qo];EVt.push(ELb);} for (var s in EGu){var fAdd=true;for (var i=0;i<EVt.length;i++){if (EGu[s].Bem == EVt[i].Bem){fAdd=false;break;}} if (fAdd) EVt.push(EGu[s]);} return EVt;} EKc.prototype.FKd['attachments']=true;  function EUN(sId){if (!sId) return;var oElem=AAA.EcK.getElementById(this.sId=sId);oElem.innerHTML='<table class="s-stack" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td id="' + sId + '-title" class="s-attachments-title">' + oElem.getAttribute('com_ibm_dwa_ui_attachmentsReader_title') + '</td></tr><tr><td id="' + sId + '-attachments" class="s-attachments-text" style="height:100%;vertical-align:middle;"></td></tr></tbody></table>';} EUN.prototype.cl='EUN';EUN.prototype.EMi=function EZx(oNote, EVt, fNoAccess){var oDate=oNote.EHA('s_DocCreated', 0);Evf=oDate ? new EJw(7).format((new EYB).setDate(oDate)) : '';var Eda=AAA.EcK.getElementById(this.sId + '-title');Eda.innerHTML+=!fNoAccess ? (' ' + "(Click the filename to launch)") : '';var GQf=AAA.BYp('dropdownarrow.gif');var Czm=[], n=0;var FZQ=[];var GsS=AAA.FWz.GWe && !AAA.FGG && (!window.Sealed || window.Sealed == '0');if(GsS) EKc.prototype.EQj['Guy'] = ['Quickr', 'QuickrOutlineElements', 'MiscWidgets', 'Dialog', 'Xml', 'OutlineFull', 'UtilsFull'];for (var i=0;i < EVt.length;i++){if (!fNoAccess){var Bem=EVt[i].Bem.replace(/[\/\\%]/g, '_');if (navigator.platform && navigator.platform.indexOf('Win32') != -1) Bem=Bem.replace(/[\<>\?\*:\"\|]/g, '_');Bem=encodeURIComponent(Bem).replace(/\'/g,'%27');var Djd=encodeURIComponent(EVt[i].sName).replace(/\'/g,'%27');var DNc="../../0/" + oNote.sUnid + "/$File/" + Bem + '?OpenElement&FileName=' + Djd;var EJt=Evf;if (EVt[i].sTime){var oDate=(new EYB).EKN(EVt[i].sTime).getDate();EJt = new EJw(7).format((new EYB).setDate(oDate));} var ELf = EYX("Size: %1KB; Modified: %2", Math.ceil(EVt[i].gM / 1000), EJt);var EDh='';if (AAA.FWz.GUR != "1") EDh='AAA.DSq.EUN.confirmOpen(event)';var Gjo='var sId=this.id.match(/^(.*)\-dropdown\-button/)[1];var EYl=AAA.DSq.EKc.prototype.EYl;EYl[sId + \':' + this.cl + '\'].EZI(event, this);';Czm[n++]=(i > 0 ? (GsS || AAA.FWz.Gex ? '&nbsp;&nbsp;&nbsp;' : '&nbsp;&nbsp;') : '') + '<a id="' + this.sId + '-attachment-' + i + '" target=_blank href="' + DNc + '" title="'+ ELf + '" onclick="' + EDh + '"></a>';if (GsS || AAA.FWz.Gex){var GOk=AAA.MO + '/0/' + oNote.sUnid + '/$File/' + Bem;Czm[n++]='&nbsp;<img id="' + this.sId + '-dropdown-button-' + i + '" src="' + GQf + '" align="middle" title="' + Djd + '" size="' + EVt[i].gM + '"' + (GsS ? ' atturl="' + GOk + '"' : '') + ' onclick="' + Gjo + '">';FZQ.push(GOk);}} else{Czm[n++]=(i > 0 ? '&nbsp;&nbsp;' : '') + '<span id="' + this.sId + '-attachment-' + i + '"></span>';}} if (GsS && FZQ.length > 0){var GKR=this.sId.replace(/([^-]+)-([^-]+-[^-]+)-.*/,'$1-form-$2');Eda.innerHTML+='&nbsp;&nbsp;<a href="javascript:void(0);" onclick="AAA.DSq.ELU(null, \'' + this.sId + '\', \'Guy\',{GKR:\'' + GKR + '\', aAttUrls:[\'' + FZQ.join('\',\'') + '\']});return false;">' + "Save All to a Lotus Quickr Place..." + '</a>';} var oElem=AAA.EcK.getElementById(this.sId + '-attachments');oElem.innerHTML=Czm.join('');for (var i=0;i < EVt.length;i++){var oElem=AAA.EcK.getElementById(this.sId + '-attachment-' + i);EVF(oElem, EVt[i].Bem);} EPx.get('p-'+ this.sId + '-mode').BRW(1);};EUN.prototype.EZI=function GcV(ev, Btk){var sId=Btk.id + '-dropdown';var EQg=ECi.get('root');if (!EQg.oHtml[sId]){var GOk=Btk.getAttribute('atturl');var CXv=Btk.getAttribute('title');var EPL=Btk.getAttribute('size');var GsS=AAA.FWz.GWe && !AAA.FGG && (!window.Sealed || window.Sealed == '0');var EdD=[];var CAb=[];if (GsS){var GKR=this.sId.replace(/([^-]+)-([^-]+-[^-]+)-.*/,'$1-form-$2');EdD.push("Save to a Lotus Quickr Place...");CAb.push('Guy{GKR:\'' + GKR + '\', aAttUrls:[\'' + GOk + '\']}');} if (AAA.FWz.Gex){EdD.push("View file");CAb.push('GGA{CXv: \'' + CXv + '\', sId: \'' + sId + '\', EPL: \'' + EPL + '\'}');} EQg.oHtml[sId]='<div id="' + sId + '" class="s-popup" com_ibm_dwa_ui_widget_class="EFX" com_ibm_dwa_ui_dropdownMenu_captions="' + EdD.join('|') + '" com_ibm_dwa_ui_dropdownMenu_actions="' + CAb.join('|') + '"></div>';} EQg.EGK=true;EQg.CWh(ev, Btk);EQg.show(ev, sId);};function GGA(sId){var EJs=ELU.EJs[this.sId=sId];var CXv=EJs.CXv;var sId=EJs.sId;var EPL=EJs.EPL;var fSize=false;if(EPL >= 5242880){if(confirm("You selected to view an attachment that is  5MB or more.  This may take a long time to open.\nDo you want to continue opening?")){fSize=true;}} if((EPL < 5242880) || (fSize == true)){if(AAA.s_DocumentForm - 0){var sUrl=AAA.MO + '/' + EJs.DWf + '/' + EJs.EIX[0] + '/$File/?ViewElement&FileName=' + EJs.CXv + '&outputformat=html' + (EJs.DWf == "($SoftDeletions)" ? '&OpenSoftDeleted' : '');var nLeft=Math.floor((screen.width - 12 - 650) / 2);var nTop=Math.floor((screen.height - 31 - 540) / 2);var sAttr='scrollbars=yes,resizable=yes,left=' + nLeft + ',top=' + nTop + ',width=' + 650 + ',height=' + 540;window.open(sUrl, '_blank', sAttr);} else{var GOJ={CXv: CXv};ELU(null, sId, 'Gbi', GOJ);}}} EUN.confirmOpen=function GjC(ev){if (!confirm("You are opening an attachment using an application. Doing so may be a security risk. Do you want to continue?")) ev.preventDefault();};EbS.prototype.GcR=function GVO(Blr){var EcK=AAA.EcK;var EnZ=Blr.oNote.EHA('s_AllAttachmentNames');var EZL=(EnZ instanceof Array ? EnZ : EnZ ? [EnZ] : []);var YT=0;for (var i=0;i < EZL.length;i++) YT+=!!EZL[i] - 0;var Edk=EPx.get('p-e-' + Blr.sId + '-attachmentsarea-mode');if (!YT || '1' == Blr.oNote.EHA('Sealed', 0) ){Edk.BRW(0);return;} var EgU=EcK.getElementById('e-form-' + Blr.sId);if (!EgU) return;var Fxe=EgU.getAttribute('com_ibm_dwa_ui_document_previewmode') == 'true';var GZS=false;var cl=!GZS ? 'EUN' : 'Gbc';if (GZS){GHF=' com_ibm_dwa_ui_fullAttachmentsReader_title="' + "Attachments:" + '" com_ibm_dwa_ui_fullAttachmentsReader_bgColor="#f7f7f7" com_ibm_dwa_ui_fullAttachmentsReader_sUnid="' + Blr.oNote.sUnid + '"';} else{var GHF=' com_ibm_dwa_ui_attachmentsReader_title="' + "Attachments:" + '"';} EcK.getElementById('e-' + Blr.sId + '-attachmentsarea-container').innerHTML = '<div class="s-basicpanel" id="e-' + Blr.sId + '-attachmentsarea" com_ibm_dwa_ui_widget_class="' + cl + '" com_ibm_dwa_ui_widget_delayed="true"' + GHF + ' style="overflow:auto;"></div>';EKc.prototype.ESH['e-' + Blr.sId + '-attachmentsarea:' + cl]=function(){var EVt=EPw(Blr.oNote, EcK.getElementById('e-' + Blr.sId + '-body'));if (!EVt[0]){Edk.BRW(0);return;} var Edp = EKc.prototype.EYl['e-' + Blr.sId + '-attachmentsarea:' + cl];Edp.EMi(Blr.oNote, EVt, AAA.FWz.FcF || (Blr.DWf == "($SoftDeletions)"));};EPl(EcK.getElementById('e-' + Blr.sId + '-attachmentsarea'), true);};EKc.prototype.FKd['attachmentsread']=true;                                                                 